\documentclass[10pt,twocolumn,letterpaper]{article}

\usepackage{cvpr}
\usepackage{times}
\usepackage{epsfig}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{color}
\usepackage{mathtools}
\usepackage{mathptmx}
\usepackage[11pt]{moresize}
\usepackage{wrapfig}
\usepackage{bbm}
\usepackage{xcolor}
\usepackage{tabularx}
\usepackage{bm}



\newcommand{\R}{\mathbb{R}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\V}{\mathbb{V}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\K}{\mathbb{K}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\I}{\mathbb{I}}

\newcommand{\add}{\textcolor{red}{[insert]}}


% Include other packages here, before hyperref.

% If you comment hyperref and then uncomment it, you should delete
% egpaper.aux before re-running latex.  (Or just hit 'q' on the first latex
% run, let it finish, and you should be clear).
\usepackage[breaklinks=true,bookmarks=false]{hyperref}

\cvprfinalcopy % *** Uncomment this line for the final submission

\def\cvprPaperID{****} % *** Enter the CVPR Paper ID here
\def\httilde{\mbox{\tt\raisebox{-.5ex}{\symbol{126}}}}

% Pages are numbered in submission mode, and unnumbered in camera-ready
%\ifcvprfinal\pagestyle{empty}\fi
\setcounter{page}{1}
\begin{document}

%%%%%%%%% TITLE
\title{ Stochastic Wind Power Forecasting }  % \\  \small{Report}}

\author{ Waleed Alhaddad\textsuperscript{\textasteriskcentered} \qquad Ahmed Kebaier\textsuperscript{\ddag} \qquad Ra\'ul  Tempone\textsuperscript{\textasteriskcentered}\textsuperscript{\textdagger} \\
\textsuperscript{\textasteriskcentered}CEMSE Division, King Abdullah University of Science and Technology (KAUST), Saudi Arabia \\ \textsuperscript{\textdagger}Alexander von Humboldt Professor, RWTH Aachen University,  Germany
 \\ \textsuperscript{\ddag}Université Paris 13, Sorbonne Paris Cité, LAGA, CNRS (UMR 7539) , Villetaneuse , France }

\maketitle
%\thispagestyle{empty}

%%%%%%%%% ABSTRACT

\begin{abstract}



Reliable wind power generation forecasting is crucial for applications such as the allocation of energy reserves, optimization of electricity price and Operation scheduling of conventional power plant. We propose a data driven model based on parametric Stochastic Differential Equations (SDEs) to captures real-world asymmetric dynamics of wind power forecast errors. The SDE proposed incorporates time derivative tracking of the forecast, time-dependent mean reversion parameter and an improved diffusion term. We are able to simulate future wind power production paths and confidence bands. The method is forecast technology agnostic and enables the comparison between different forecasting technologies on the basis of an information criteria. We apply the model to historical Uruguayan and French wind power production data and various forecasts on the period (2017-2018).


\end{abstract}

%%%%%%%%% BODY TEXT
\section{Introduction}

Reliable wind power generation forecasting is crucial for the following applications [ref]:
\begin{itemize}
\item Allocation of energy reserves such as water levels in dams or oil and gas reserves.
\item Operation scheduling of non-controlable power plants.
\item Optimization of the price of electricity for different parties such as electric utilities, Transmission system operator (TSOs), Electricity Service providers (ESPs), Independent power producers (IPPs), and energy traders.
\item Maintenance planning such as that of power plants components and transmission lines.

\end{itemize}

Different methods have been applied to wind power forecasting. They can be generally categorized as follows: physical models, statistical methods, artificial intelligence methods and hybrid approaches. The output of such methods is usually a deterministic forecast. Occasionally probabilistic forecasts are produced through uncertainty propagation in the data, parameters or through forecast ensembles. However, there is a lacking in simulating and producing data driven stochastic forecasts based on real-world performance of forecasting models. It is crucial to capture actual performance of a forecast as it has been known that different forecasting technologies exhibits different behavior for different wind farms and seasons [ref]. This is due to many factors which forecast are challenged to capture such as the surrounding terrains of the wind farm and the condition of the blades such as icing,wear and tear or dirt. It is known that complex terrains in both off shore and on shore locations decrease the accuracy of wind power forecasts significantly [ref]. It also has been shown that the performance of forecasts varies from month to month. Thus the performance of wind power forecasts is location and time dependent.

Many approaches have been taken to evaluate the uncertainty of a given forecast. There are two types of errors: level errors and phase errors. The use of mean or median errors in this context may be misleading as wind power forecast errors are asymmetric. This is a natural consequence of wind power being non-negative and bounded by the maximuim capacity of production. This is important as the associated cost to power forecast errors are also asymmetric due to different costs for up and down  power regulations which are determined by the electricity market [ref].

We propose to model wind power forecasts errors using parametric stochastic differential equations (SDEs) whose solution defines a stochastic process. This resultant stochastic process describes the time evolution dynamics of wind power forecast errors while capturing properties such as a correlation structure and the inherent asymmetry. Additionally, the model we propose is agnostic of the forecasting technology and serves to complement forecasting procedures by providing a data driven stochastic forecast. Hence, we are able to evaluate wind power forecasts according to their real-world performance and we are able to compare different forecasting technologies. Most notably, we are able to simulate future wind power production given a deterministic wind power forecast. Future wind power production as well as the analytical form of the proposed SDE can be used in optimal control problems involving wind power production.

Previous attempt by M\o ller et al. (M\o ller, Zugno, \& Madsen, 2016)  considered stochastic wind power forecast models based on stochastic differential equations (SDEs). Here, we propose an improved model featuring time derivative tracking of the forecast, time-dependent mean reversion, modified diffusion and non-Gaussian approximations. We apply the model to Uruguayan and french wind power forecasts together with historical wind power production data pertaining to the year 2017-2018.

We use a year long data set from Uruguay based on 1000 observation paths, each of which is 72-hours long with observations recorded every 10 min. In total, it is a data set of approximatly half a million data points recorded in 2018. See figure (\ref{fig:sample_data}). The data is normalized with respect to the maximuim power capacity of wind power production in Uruguay. The asymmetry or skew nature of the data is clear when inspected for different power production levels. We split the aggregated data into a low, meduim and high power range. See figure (\ref{fig:skew_data}).

In this paper we present the phenomenological underlaying model in section (2) and describe the physical constraints in section (3) and how these constrains can be met. Then, in section (4), we will introduce an alternative formulation of the model in Lamperti space. In section (5), we show our parameter estimation procedure and its results in section (6). We compare alternative models in section (7) and different forecast providers in section (8).
\begin{figure}
  \includegraphics[width=40mm,scale=1]{plots/data_1516064400.pdf}
  \includegraphics[width=40mm,scale=1]{plots/data_1516323600.pdf}\\
  \caption{Two samples from the Uruguayan of 2018. Each sample compromises of two 72-hour paths. In yellow is an hourly wind power production forecast. In blue is the actual wind power production recorded in 10 minute intervals.}
  \label{fig:sample_data}
\end{figure}

\begin{figure}
  \includegraphics[width=26mm,scale=1]{plots/hist_low.pdf}
  \includegraphics[width=26mm,scale=1]{plots/hist_mid.pdf}
  \includegraphics[width=26mm,scale=1]{plots/hist_high.pdf}
  \caption{We see that forecast errors exhibit skewness near the boundries (i.e. low and high power production regimes.). Low power is when produced power is less than $0.3$, mid power is when it is between $0.3$ and $0.6$ and high power when is larger than $0.6$. }
  \label{fig:skew_data}
\end{figure}

\begin{figure}
  \includegraphics[width=26mm,scale=1]{plots/hist_low_lamperti.pdf}
  \includegraphics[width=26mm,scale=1]{plots/hist_mid_lamperti.pdf}
  \includegraphics[width=26mm,scale=1]{plots/hist_high_lamperti.pdf}
  \caption{We observe that skewness has been greatly reduced after the Lamperti transformation. This motivates us to use a Gaussian transition density as a proxy density.}
  \label{fig:skew_after_lamperti}
\end{figure}

%-------------------------------------------------------------------------
\section{Phenomenological  Model}
We introduce the following phenomenological model. Let $X_t$ be the  wind power generation forecasts stochastic process defined by the  following parameterized stochastic differential equation (SDE),
\begin{equation}
\begin{split}
dX_t &= a(X_t; p_t, \dot{p}_t,\bm{\theta}) \ dt + b (X_t;p_t, \bm{\theta} ) \ dW_t \quad t > 0 \\
X_0 & = x_0
\end{split}
\label{main}
\end{equation}

\begin{itemize}
\item $a(\cdot; p_t, \dot{p}_t,\bm{\theta}):[0,1] \to \R \ $  a drift function.
\item $b (\cdot;p_t, \bm{\theta} ):[0,1] \to \R \ $  a  diffusion function.
\item $\bm{\theta}$: a vector of parameters.
\item $p_t$ time-dependent scalar value and $ \dot{p}_t$ is its time derivative at time $t$. (in our case  $p_t$ is a deterministic forecast).
\item $W_t$: Standard Wiener random process in $\R$.
\end{itemize}

We would like to have this model closely follow wind power forecasts while ensuring that it is unbiased with respect to the forecast. It straightforward to show that $\E X_t = p_t$ where $p_t$ is a deterministic given wind power forecast in the model above.

\subsection{Physical Constrains}

Let $p_t$ be a numerical wind power forecast, which is an input to this approach. Then the model is given by the following It\^{o} stochastic differential equation,
\begin{equation}
\begin{split}
dX_t&= \dot{p} \ dt - \theta_t(X_t - p_t) \ dt + b (X_t; \bm{\theta} ) \ dW_t \quad t > 0 \\
X_0&=x_0
\end{split}
\label{model:derivative_tracking_X}
\end{equation}

We have that the process $X_t$ mean reverts to the wind power forecast $p_t$ and tracks its the time derivative $\dot{p}_t$.  An example such mean reverting model without derivative tracking exhibits consistent lags as shown in Figure (\ref{fig:derivative_tracking}). See section (7) for comparisons.

\begin{figure}
  %\includegraphics[width=26mm,scale=1]{}
  \caption{insert figure showing the difference with and without derivative tracking}
  \label{fig:derivative_tracking}
\end{figure}



 We normalize the forecast and production data to Uruguay  installed power capacity. at the time of observation. Thus our process must be limited to the range $[0,1]$. To enforce this constraint, we our  drift and diffusion terms  must satisfy certain rules.
 

Let $\bm{\theta} = (\theta_0,\alpha)$. We would like that the process to follow the wind forecast, thus we choose a drift term that is mean reverting and tracks the derivative of the deterministic forecast $p_t$, which is an input to our model.
  \begin{equation}
    a(x; p_t,\bm{\theta})=  \dot{p_t} - \theta_t(x - p_t)
  \end{equation}
where $\theta_t>0$ is a time-dependent parameter that controls the speed of reversion.


We would like  a diffusion term that vanishes at the boundaries to prevent the process from escaping the region $[0,1]$.
  \begin{equation}
    b (x; p_t,\bm{\theta} )= \sqrt{2 \theta_t \alpha x (1-x)}
  \end{equation}
  where $\alpha >0$ is a constant parameter that controls the path variability. This diffusion term belongs to the Pearson diffusion family and , in particular, it is a Jacobi type diffusion.

To further ensure that the process does not escape the region $[0,1]$, the mean reversion parameter has to be selected according to the following rule. Observe that the time derivative term $\dot{p}_t $ is not controlled to maintain that $X_t$ stays a.s.  inside the range $[0,1]$. In other words, the zero drift line defined by $a(x; p_t,\bm{\theta}) =0$, which an attractor, must be contained inside the range $[0,1]$. Thus, we must have that
\begin{equation}
\frac{- |\dot{p_t}|}{p_t} \leq \theta \leq \frac{|\dot{p}_t|}{1- p_t}
\end{equation}
which is satisfied  by choosing a time-dependent  $\theta_t$ as follows,
\begin{equation}
\theta_t = \max \left( \theta_0 \ , \ \frac{|\dot{p}_t|}{\min (p_t, 1-p_t)}  \right ),  \quad \theta_0 >0 \label{theta_t}
\end{equation}

\subsubsection*{Change of Variables:}
To avoid differentiation of the forecast $p_t$ and simplify, we apply a change of variables $$V_t = X_t - p_t$$ \\
The  model becomes,
\begin{equation}
\begin{split}
dV_t &=  - \theta_t V_t \  dt + \sqrt{2 \theta_t \alpha (V_t +p_t ) (1-V_t-p_t)} \  dW_t  \\ %\quad t > 0
V_0 & = v_0\\
% \theta_t &= \max \left( \theta_0 \ , \ \frac{|\dot{p}_t|}{\min (p_t, 1-p_t)}  \right )\\
\end{split}\label{VtSDE}
\end{equation}

\section{State independent diffusion formulation:}
The model we have demonstrated previously (\ref{VtSDE}) is  a state-dependent diffusion formulation, that is the diffusion of the SDE clearly depends on the state.  We are interested in state independent diffusion as it is more tractable and numerically stable.To achieve that, we apply a Lamperti transform to obtain the following state-independent diffusion SDE,
\begin{equation}
  \begin{split}
    dZ_t&= \frac{- \theta_t (1+ \sin(Z_t) - 2p_t) + \alpha \theta_t \sin (Z_t)   }{\cos (Z_t)} \ dt + \sqrt{2 \alpha \theta_t} dW_t \\
    Z_0&=z_0
  \end{split}
\end{equation}
where the Lamperti trasform is given by $Z_t = \arcsin \left( \frac{1}{2} \left( V_t+p_t \right) - 1 \right) $. We can see in figure (\ref{fig:skew_after_lamperti} ) the effects of the Lamperti transform on the forecast error data. The Lamperti transform has greatly reduced  the forecast error skewness and ensures that the process stays in the range $[0,1]$. Thus, in this case,  we can consider using a Gaussian density as a proxy transition density.


\section{Inference and Optimization}

\subsection{Likelihood}


Since $V_t$ defined by our SDE is Markovian, the likelihood function can be written as a product of transition densities.  Consider a set of M paths with N observations each, $ V^{M,N}=\{ V_{t_1^{M,N}} , V_{t_2^{M,N}} ,\ldots , V_{t_N^{M,N}} \}$ observed in intervals of $\Delta_N$.

\begin{equation}
\mathcal{L}(\theta;V) =\prod\limits_{j=1}^M \prod\limits_{i=1}^N \rho ( {V_{j,i+1}|V_{j,i}},\bm{\theta} )  \rho (V_{j,0})
\label{likelihood}
\end{equation}

The transition densities can be exactly obtained by solving the following parametric Fokker-Planck equation,

\begin{equation}
\begin{split}
\frac{ \partial f }{\partial t } & (y ,t | x , s, \theta_0 , \alpha )= - \frac{\partial}{ \partial y} ( a( y;  p_t, \dot{p}_t, \theta_0 ) f( y ,t | x , s, \theta_0  , \alpha ) ) \\
& + \frac{1}{2} \frac{\partial^2}{ \partial y^2} ( b^2(y; p_t, \theta_0, \alpha  )  f(y ,t | x , s,\theta_0 , \alpha ) ) \quad  t < s\\
\end{split}
\end{equation}
This is a parametric PDE which is computationally expensive to solve and optimize for every transition. Therefore, we consider approximate likelihood methods.

\subsection{Approximate Likelihood}
Solving for transition densities of the process $V_t$ requires solving the Fokker-Planck equation at every step which is computationally prohibitive. A common choice is performing a Gaussian approximation of the transition densities, but this is inappropriate here due to physical constraints which give rise to asymmetric forecasting errors as seen in figure (\ref{fig:skew_data}).\\

We propose a proxy transition density. We match the moments of our SDE model with that of the proxy density. Using It$\hat{o}$ formula, we arrive at the following iterative ODEs for the state dependent diffusion formulation (\ref{VtSDE})
\begin{equation}
\begin{split}
\frac{d \E[ V^k_t]}{dt} = - k \theta_t \E [ V^k_t] + \frac{k(k-1)}{2} \E [ V^{k-2}_t  b(V^k_t;\theta_t, \alpha)]
\end{split}
\end{equation}
For $t\in [t_{n-1}, t]$, the first two moments are given by
\begin{equation}
\begin{split}
\frac{d m_1 (t)}{dt} &= - m_1(t)\theta_t \\
\frac{d m_2 (t)}{dt} &=  -2 m_2(t)\theta_t(1+\alpha) + 2\alpha\theta_t m_1(t)(1-2p_t) \\
&\quad + 2 \alpha\theta_t p_t (1-p_t)\\
\end{split}
\end{equation}
with initial conditions, $m_1(t_{n-1})= v_{n-1}$ and $m_2(t_{n-1})= v_{n-1}^2$.

And for the state independent diffusion formulation, similarly, we  obtain a system of ODEs to determine the centered moments of the Lamperti transformed process $V_t$. Due to the non-linearity in the drift, we can only approximate the centered moments by the following ODEs,
\begin{equation}
\begin{split}
\frac{d m_1 (t)}{dt} &= - m_1(t)\theta_t (1-\alpha) - \theta (1-2 p_t) \\
\frac{d var(t)}{dt} &=  2 var(t) \theta_t (2p_t - 1 ) \tan(m_1 (t)) \sec(m_1 (t))\\
& \quad + \theta_t (\alpha - 1) \sec^2(m_1 (t))  + 2 \theta_t \alpha\\
\end{split}
\end{equation}

 A suitable candidate for a proxy transition density is a Beta probability distribution as it is compactly supported and can morph into symmetric and asymmetric shapes.

\subsubsection*{ Moment Matching}
To approximate the transition densities of  the process $V_t$ by a Beta distribution, we match its moments with the shape parameters $\xi_1, \xi_2$ of a Beta proxy density on $[-1,1]$. The any moment of the process $V_t$ is  given by solving the corresponding ODE system  for the $k^{th}$  moment,

The shape parameters are given by,
\begin{equation}
\xi_1 = - \frac{(1+\mu_t )(\mu_t^2 + \sigma_t^2 -1)}{2 \sigma_t^2} \quad \xi_2=  \frac{(\mu_t-1 )(\mu_t^2 + \sigma_t^2 -1)}{2 \sigma_t^2} \label{param_transformed_beta}
\end{equation}
where $\mu_t = m_1 (t)$ and $\sigma_t^2= m_2 (t)- m_1 (t)^2$.

\subsection{Optimization}

To initialize the the optimization process, we solve the following least-squares problem which gives us first estimates of the mean reversion parameter $\theta_0$. 

\begin{equation}
 \arg\min \sum\limits_{i}^M \sum\limits_j^N \left( v_{i+1,j}  - v_{i,j}- \left( - \theta_t v_{i,j}\right) \left(t_{i+1,j} - t_{i,j} \right)  \right)^2 
 \end{equation}
 
 where $v_{i,j}=x_{i,j}-p_{i,j}$,  $x_{i,j}$ is historical wind power production and $p_{i,j}$ is the wind power forecast.
 
 By assuming ergodicity, we can obtain a first estimate on the product of the parameters as follows,
 
\begin{equation}
\theta_0 \alpha = \frac{1}{M} \sum\limits_i^M \frac{ \sum\limits_j^N (x_{i+1,j}  - x_{i,j})^2}{2 \sum\limits_j^N x_{i,j}(1-x_{i,j}) }
\end{equation}

Solving for $\alpha$, we have both first estimates to kick start the inference processes given as follows:
\begin{enumerate}
\item[Step 1.]  initialize
\item[Step 2.]  optimize the log-likelihood function using  Nelder-Mead optimization algorithm on a mini-batch sampled with replacement.
\item[Step 3. ] check if  accuracy threshold is reached. Else, re-initialize the optimization with the most recent result on a larger mini-batch.
\end{enumerate}





\section{Model Comparison}
We compare the following candidate models to find the best-fit that maximizes the retained information,
\begin{itemize}
  \item Model 0: This model is the most basic model without derivative tracking.
  \begin{equation}
  \begin{split}
  dX_t &=  - \theta_0 (p_t-X_t) \  dt + \sqrt{2 \theta \alpha X_t (1-X_t)} \  dW_t  \\ %\quad t > 0
  X_0 & = x_0
\end{split}\label{M0}
  \end{equation}
  with $\theta_t= \theta_0 $.

  \item Model 1: This model features derivative tracking, i.e. it is equivalent to (\ref{model:derivative_tracking_X}) with a diffusion term that is forecast dependent by including the term $p_t(1-p_t)$.
  \begin{equation}
  \begin{split}
  dV_t &=  - \theta_t V_t \  dt + \sqrt{2 \theta_t \alpha p_t(1-p_t)(V_t +p_t ) (1-V_t-p_t)} \  dW_t  \\ %\quad t > 0
  V_0 & = v_0
  \end{split}\label{M2}
  \end{equation}
  with $\theta_t$ given by (\ref{theta_t}). This model has been used by [ insert ref ] and [ insert ref ]. Initial interest in this model stems from interest in long-term stationary solution, which may exists  if the forecast is constant. However, this is almost never occurs and thus including the term $p_t(1-p_t)$ is irrelevant. Additionally, the term $p_t(1-p_t)$ leads the model to become deterministic when the forecast is at the boundaries (i.e.$p=1$ or $p=0$)  which is not realistic. We have run computations on this model and the results were not satisfactory. Therefore, we exclude this model from further discussions.
  
  \item Model 2: This model features derivative tracking, i.e. it's equivalent to (\ref{model:derivative_tracking_X}).
\begin{equation}
  \begin{split}
  dV_t &=  - \theta_t V_t \  dt + \sqrt{2 \theta_t \alpha (V_t +p_t ) (1-V_t-p_t)} \  dW_t  \\ %\quad t > 0
  V_0 & = v_0
  \end{split}\label{M2}
  \end{equation}
  with $\theta_t$ given by (\ref{theta_t}).
\end{itemize}


\begin{table}[]
\centering
\begin{tabular}{|c|c|c|c|}
\hline
Model   &  parameters $(\theta_0, \alpha)$   & AIC & BIC \\ \hline
Model 0 &  $(\add,\add) $    &  \add   &  \add   \\ \hline
Model 2 &   $(\add,\add)$   &  \add   &   \add    \\ \hline
\end{tabular}
\caption{We compare the different models based on information criterion. \add }
\label{tab:model_comparison}
\end{table}



\section{Forecast Provider Comparison}
We compare forecasts from two different companies for the same period.
\begin{table}[]
\centering
\begin{tabular}{|c|l|c|c|}
\hline
Forecast Provider & parameters $(\theta_0, \alpha)$ & AIC & BIC \\ \hline
Provider A  &  $(\add,\add)$      &  \add   & \add    \\ \hline
Provider B  & $(\add,\add) $  &  \add   &   \add  \\ \hline
\end{tabular}
\caption{\add}
\label{tab:forcast_comparison}
\end{table}
In Figure (\add)-(\add), we see that forecast provider A is of better quality than provider B. This is confirmed by both the AIC and BIC information criteria.


 \begin{table}[]
 \centering
 \begin{tabular}{|c|l|c|c|}
 \hline
 Model & parameters $(\theta_0, \alpha)$  \\ \hline
 \begin{tabular}[c]{@{}c@{}}low frequency data\\ (hourly)\end{tabular}               &  $(\add,\add) \pm (\add,\add)$   \\ \hline
 \begin{tabular}[c]{@{}c@{}}high frequency data\\  (every 10 minutes)\end{tabular} &  $(\add,\add) \pm (\add,\add)$      \\ \hline
 \end{tabular}
 \caption{ \add confidence interval obtained using bootstrap}
 \label{tab:freq_comparison}
 \end{table}


%\section{Model on Disaggregated Data}
%We apply Model 2 to disaggregated wind power production data and forecasts. The data is available in this case on an hourly basis. Results are shown in Table (\ref{tab:disagregated_data}).
%
%\begin{table}[]
%\centering
%\begin{tabular}{|c|c|c|c|}
%\hline
%Forecast Provider A & parameters $(\theta_0, \alpha)$ & AIC & BIC \\ \hline
%Wind Farm 1         &                                 &     &     \\ \hline
%Wind Farm 2         &                                 &     &     \\ \hline
%Wind Farm 3         &                                 &     &     \\ \hline
%Wind Farm 4         &                                 &     &     \\ \hline
%Wind Farm 5         &                                 &     &     \\ \hline
%Wind Farm 6         &                                 &     &     \\ \hline
%\end{tabular}
%\caption{<discuss results>}
%\label{tab:disagregated_data}
%\end{table}
%
%\begin{table}[]
%\centering
%\begin{tabular}{|c|c|c|c|}
%\hline
%Forecast Provider B & parameters $(\theta_0, \alpha)$ & AIC & BIC \\ \hline
%Wind Farm 1         &                                 &     &     \\ \hline
%Wind Farm 2         &                                 &     &     \\ \hline
%Wind Farm 3         &                                 &     &     \\ \hline
%Wind Farm 4         &                                 &     &     \\ \hline
%Wind Farm 5         &                                 &     &     \\ \hline
%Wind Farm 6         &                                 &     &     \\ \hline
%\end{tabular}
%\caption{\textless{}discuss results\textgreater{}}
%\label{tab:disagregated_data_B}
%\end{table}

\section{Results}


We were able to obtain the following for 
\begin{table}[]
\centering
\begin{tabular}{|c|c|}
\hline
Formulation   &  parameters $(\theta_0, \alpha)$    \\ \hline
Without Lamperti transform &   $(12,0.3) \pm (\add , \add) $   \\ \hline
With Lamperti transform &   $(12,0.29) \pm (\add , \add)  $   \\ \hline
\end{tabular}
\caption{We compare the parameters obtained in both the original and Lamperti space. Parameters have been obtained based on \add data points from the Uruguayan pertaining to the year 2018  \add }.
\label{tab:model_comparison}
\end{table}


 We are able to obtain the parameters based on the complete data sets. Using the different models variations, we are able to simulate wind power production given a forecast. We see in figures ()-()
five possible wind power production paths for each model.\\


In Figures ()-(), we show point-wise empirical confidence bands for the different models.

\begin{figure}
  \includegraphics[width=39mm,scale=1]{plots/alpha_conv_beta.png}
  \includegraphics[width=39mm,scale=1]{plots/theta_conv_beta.png}
  \caption{We show self-convergence of our algorithm applied to model $2$. We conlcude that the rate  matches that of of Monte Carlo. Data is from Uruguay pertaining to  year 2018. }
\end{figure}


    \begin{figure}
      \includegraphics[width=75mm,scale=1]{simulated/24hr/1099.pdf}
      \includegraphics[width=75mm,scale=1]{simulated/24hr/1178.pdf}
      \caption{We simulate following model 2  five possible future wind power production paths using the obtained optimal parameters $(\theta_0, \alpha )=(12,0.3)$. Forecast is from Uruguay pertaining to  year 2018. }
    \end{figure}


    \begin{figure}
      \includegraphics[width=75mm,scale=1]{confidence_intervals/24hr/31.pdf}
      \includegraphics[width=75mm,scale=1]{confidence_intervals/24hr/820.pdf}
       \caption{We obtain confidence intervals following model 2  for future wind power production using the obtained optimal parameters $(\theta_0, \alpha )=(12,0.3)$. Actual production plotted in retrospect. Forecast and data is from Uruguay pertaining to  year 2018. }
    \end{figure}

\section{Conclusions}

We have proposed a method to produce stochastic wind power forecasts based on parametric SDEs. This method is agnostic of the wind power forecasting technology. Using this method, we were able to simulate future wind power production paths and obtain confidence bands. We conclude that Model 2 is a best-fit model. It features time-derivative tracking of the forecast, time-dependent mean reversion parameter, and a more natural diffusion term. Moreover, the model preserves the asymmetry of wind power forecast errors and their correlation structure.

We were also able to compare two different forecast providers with respect to their real-world performance on the aggregated data set and on specific wind farm sites. Finally, the model paves the way for stochastic optimal control methods enabling optimal decision making under uncertainty.






%\section*{Acknowledgement}

\section*{References}
\begin{flushleft}
- M\o ller, J. K., Zugno, M., \& Madsen, H. (2016). Probabilistic Forecasts of Wind Power Generation by Stochastic Differential Equation Models. Journal of Forecasting, 35(3), 189-205. doi:10.1002/for.2367 \linebreak
- G. Giebel, R. Brownsword, G. Kariniotakis, M. Denhard, and C. Draxl, The State-Of-The-Art in Short-Term Prediction of Wind Power: A Literature Overview, 2nd edition. ANEMOS.plus, 2011, project funded by the European Commission under the 6th Framework Program, Priority 6.1: Sustainable Energy Systems.\linebreak
- Ravn, H. F. (2006). Short term wind power prognosis with different success criteria. 2006 International Conference on Probabilistic Methods Applied to Power Systems. doi:10.1109/pmaps.2006.360291 \linebreak
- Chang, W. (2014). A Literature Review of Wind Forecasting Methods. Journal of Power and Energy Engineering, 02(04), 161-168. doi:10.4236/jpee.2014.24023\linebreak
- Elkantassi, S., Kalligiannaki, E., \& Tempone, R. (2017). Inference And Sensitivity In Stochastic Wind Power Forecast Models. Proceedings of the 2nd International Conference on Uncertainty Quantification in Computational Sciences and Engineering (UNCECOMP 2017). doi:10.7712/120217.5377.16899
\end{flushleft}





% {\small
% \bibliographystyle{ieee}
% \bibliography{egbib}
% }

\end{document}


% \begin{figure}[t]
% \begin{center}
% %\fbox{\rule{0pt}{2in} \rule{0.9\linewidth}{0pt}}
%    \includegraphics[width=0.8\linewidth]{Forecast_data_68.pdf}
%     \includegraphics[width=0.8\linewidth]{Forecast_data_82.pdf}
% \end{center}
%    \caption{Examples of wind power generation from the data set along with the wind power generation forecast.}
% \label{fig:long}
% \label{fig:onecol}
% \end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \begin{figure}[t]
% \begin{center}
% %\fbox{\rule{0pt}{2in} \rule{0.9\linewidth}{0pt}}
%    \includegraphics[width=0.6\linewidth]{ellipse1193_samples_dN=14e-02.pdf}
%     \includegraphics[width=0.6\linewidth]{ellipse_conv_samples_dN=14e-02.pdf}
% \end{center}
%    \caption{Left:Shrinkage of the ellipse determined by the Hessian matrix of the log-likelihood around the point of optimality $(\theta_0^*, \alpha^*)\approx (8,1)$ (Axis are not in natural scale, arrows only to  eignevector direction). Right: Convergence of the major and semi-axis of the ellipse  of the Hessian of the log-likelihood at the point optimality $(\theta_0^*, \alpha^*)\approx (8,1)$. Note that it is slightly faster than the expected rate of $1/\sqrt{M}$. This is due to the correlation structure of the process $V_t$, thus a path may act  as more than one  uncorrelated sample.}
% \label{ellipse_drawing}
% \end{figure}

%  \begin{figure}[t]
% \begin{center}
% %\fbox{\rule{0pt}{2in} \rule{0.9\linewidth}{0pt}}
%    \includegraphics[width=0.9\linewidth]{ISO_100_samples_dN=14e-02.pdf}
%    %\includegraphics[width=0.5\linewidth]{ISO_500_samples_dN=14e-02.pdf}
%    %\includegraphics[width=0.5\linewidth]{ISO_1193_samples_dN=14e-02.pdf}
% \end{center}
%    \caption{Contour plot of the log-likelihood with only 100 sample paths, point of optimality $(\theta_0^*, \alpha^*)\approx (8,1)$ indicated by the  black dot.}
% \label{contour}
% \end{figure}


%%%%%%%%%%%%%%%%%%%%%%

% \begin{figure}[t]
% \begin{center}
% %\fbox{\rule{0pt}{2in} \rule{0.9\linewidth}{0pt}}
%    \includegraphics[width=0.8\linewidth]{72hr_forecast_CI_31.pdf} %667
%    \includegraphics[width=0.8\linewidth]{72hr_forecast_CI_437.pdf}
%    \includegraphics[width=0.8\linewidth]{72hr_forecast_CI_82.pdf}
%
% \end{center}
%    \caption{ Examples of confidence bands obtained for the full 72 hour forecasts.We can see that the model captures the fluctuations in the actual production with non-trivial and asymmetric confidence intervals.}
% \label{fig:72hr}
% \end{figure}
%
% \begin{figure}[t]
% \begin{center}
% %\fbox{\rule{0pt}{2in} \rule{0.9\linewidth}{0pt}}
%    \includegraphics[width=0.8\linewidth]{6hr_forecast_CI_75.pdf}  %569
%    \includegraphics[width=0.8\linewidth]{6hr_forecast_CI_59.pdf}
%    %\includegraphics[width=0.9\linewidth]{6hr_forecast_CI_68.pdf}
% \end{center}
%    \caption{ Examples of confidence bands obtained for the first 6 hours of the forecasts. This is important as this specific forecasting company computes a new forecast every 6 hours for reliability.}
% \label{fig:6hr}
% \end{figure}


%  \begin{figure}[t]
% \begin{center}
% %\fbox{\rule{0pt}{2in} \rule{0.9\linewidth}{0pt}}
%    \includegraphics[width=0.8\linewidth]{72hr_forecast_CI_623.pdf}  %569
% \end{center}
%    \caption{ Examples of omitted data which corresponds to production control and manual energy management decisions. In this example,  wind power production was repeatedly curtailed at around 2 AM which is a period of low power demand. Automatic detection of such scenarios is to be incorporated in future works.}
% \label{fig:6hr}
% \end{figure}

%We obtain the modified Beta distribution,
%
%\begin{equation}
%\begin{split}
%f_Y(y; \alpha , \beta )&= f_X(g^{-1}(y) ) \Big| \frac{\partial g^{-1}(y)}{\partial y }  \Big| \\
%&= \frac{1}{B(\alpha, \beta) (b-a)} \Big(\frac{a-y}{b-a}\Big)^{\alpha -1}\Big(1-\frac{a-y}{b-a} \Big)^{\beta -1} \label{modified_Beta}
%\end{split}
%\end{equation}
%where $B(\cdot,\cdot)$ is the Beta function. Also, we have that
%\begin{equation}
%\E[Y]= a + (b-a) \frac{\alpha}{\alpha + \beta}
%\end{equation}
%\begin{equation}
%\V[Y]= (b-a)^2 \frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)}
%\end{equation}
